A complete, step-by-step guide for executing SQL analytics on Zomato-style transactional data.
This project covers data cleaning, quality checks, UX funnel analysis, channel & device performance, city-wise insights, and RFM customer segmentation.

ðŸ“Œ Project Structure
zomato-sql-analytics/
â”‚
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ users.csv
â”‚   â”œâ”€â”€ app_sessions.csv
â”‚   â”œâ”€â”€ app_pageviews.csv
â”‚   â”œâ”€â”€ orders.csv
â”‚   â”œâ”€â”€ order_items.csv
â”‚   â”œâ”€â”€ order_items_cancelled.csv
â”‚   â”œâ”€â”€ restaurants.csv
â”‚   â””â”€â”€ menu.csv
â”‚
â”œâ”€â”€ sql/
â”‚   â”œâ”€â”€ 01_data_setup.sql
â”‚   â”œâ”€â”€ 02_funnel_analysis.sql
â”‚   â”œâ”€â”€ 03_channel_device_analysis.sql
â”‚   â”œâ”€â”€ 04_city_analysis.sql
â”‚   â””â”€â”€ 05_rfm_segmentation.sql
â”‚
â””â”€â”€ README.md

ðŸ§© Part 1: Database Setup & Data Cleaning
Overview

Import 8 CSV files into MySQL and validate data integrity before analysis.

1.1 Create Database
CREATE DATABASE zomato;
USE zomato;

1.2 Import CSV Files
LOAD DATA INFILE '/path/to/users.csv'
INTO TABLE users
FIELDS TERMINATED BY ','
ENCLOSED BY '"'
LINES TERMINATED BY '\n'
IGNORE 1 ROWS;

LOAD DATA INFILE '/path/to/app_sessions.csv'
INTO TABLE app_sessions
FIELDS TERMINATED BY ','
ENCLOSED BY '"'
LINES TERMINATED BY '\n'
IGNORE 1 ROWS;

LOAD DATA INFILE '/path/to/app_pageviews.csv'
INTO TABLE app_pageviews
FIELDS TERMINATED BY ','
ENCLOSED BY '"'
LINES TERMINATED BY '\n'
IGNORE 1 ROWS;

LOAD DATA INFILE '/path/to/orders.csv'
INTO TABLE orders
FIELDS TERMINATED BY ','
ENCLOSED BY '"'
LINES TERMINATED BY '\n'
IGNORE 1 ROWS;

LOAD DATA INFILE '/path/to/order_items.csv'
INTO TABLE order_items
FIELDS TERMINATED BY ','
ENCLOSED BY '"'
LINES TERMINATED BY '\n'
IGNORE 1 ROWS;

LOAD DATA INFILE '/path/to/order_items_cancelled.csv'
INTO TABLE order_items_cancelled
FIELDS TERMINATED BY ','
ENCLOSED BY '"'
LINES TERMINATED BY '\n'
IGNORE 1 ROWS;

LOAD DATA INFILE '/path/to/restaurants.csv'
INTO TABLE restaurants
FIELDS TERMINATED BY ','
ENCLOSED BY '"'
LINES TERMINATED BY '\n'
IGNORE 1 ROWS;

LOAD DATA INFILE '/path/to/menu.csv'
INTO TABLE menu
FIELDS TERMINATED BY ','
ENCLOSED BY '"'
LINES TERMINATED BY '\n'
IGNORE 1 ROWS;

1.3 Verify Data Import
SELECT COUNT(*) AS users_count FROM users;
SELECT COUNT(*) AS sessions_count FROM app_sessions;
SELECT COUNT(*) AS orders_count FROM orders;
SELECT COUNT(*) AS pageviews_count FROM app_pageviews;
SELECT COUNT(*) AS order_items_count FROM order_items;
SELECT COUNT(*) AS cancelled_count FROM order_items_cancelled;
SELECT COUNT(*) AS restaurants_count FROM restaurants;
SELECT COUNT(*) AS menu_items_count FROM menu;

1.4 Duplicate Checks
SELECT user_id, COUNT(*) AS count
FROM users
GROUP BY user_id
HAVING COUNT(*) > 1;


Expected: 0 rows

1.5 Orphan Record Check
SELECT COUNT(*) AS orphaned_orders
FROM orders o
LEFT JOIN app_sessions s
ON o.app_session_id = s.app_session_id
WHERE s.app_session_id IS NULL;


Expected: 0 rows

1.6 Data Anomaly Checks
SELECT COUNT(*) AS negative_refunds
FROM order_items_cancelled
WHERE amount_of_refund < 0;

SELECT COUNT(*) AS future_orders
FROM orders
WHERE order_time > CURDATE();


Expected: 0 rows

1.7 Null Value Checks
SELECT
  SUM(CASE WHEN user_id IS NULL THEN 1 ELSE 0 END) AS null_users,
  SUM(CASE WHEN order_id IS NULL THEN 1 ELSE 0 END) AS null_orders,
  SUM(CASE WHEN total_price IS NULL THEN 1 ELSE 0 END) AS null_prices,
  SUM(CASE WHEN delivery_time IS NULL THEN 1 ELSE 0 END) AS null_delivery_times
FROM orders;

ðŸ§­ Part 2: UX Funnel Analysis
Overview

Track the user journey from homepage â†’ order completion, identify drop-offs and cart abandonment.

2.1 Cancelled Orders Aggregation
CREATE TEMPORARY TABLE cancelled_orders AS
SELECT
    order_id,
    SUM(amount_of_refund) AS total_refunds,
    MAX(created_at) AS cancelled_at
FROM order_items_cancelled
GROUP BY order_id;

2.2 Net Revenue per Order
CREATE TEMPORARY TABLE net_GMV_orders AS
SELECT
    o.order_id,
    o.app_session_id,
    o.restaurant_id,
    o.order_time,
    COALESCE(o.delivery_time, c.cancelled_at) AS final_time,
    o.delivery_fee_paid,
    o.total_price,
    c.total_refunds,
    CASE
        WHEN c.order_id IS NOT NULL THEN 'Cancelled'
        ELSE 'Completed'
    END AS order_status,
    CASE
        WHEN c.order_id IS NOT NULL THEN -c.total_refunds
        ELSE o.total_price - o.delivery_fee_paid
    END AS net_revenue
FROM orders o
LEFT JOIN cancelled_orders c
ON o.order_id = c.order_id;

2.3 Funnel Stage Flags
CREATE TEMPORARY TABLE pageviews_per_session AS
SELECT
    app_session_id,
    MAX(CASE WHEN pageview_url = '/home-page' THEN 1 ELSE 0 END) AS homepage_views,
    MAX(CASE WHEN pageview_url = '/search' THEN 1 ELSE 0 END) AS search_views,
    MAX(CASE WHEN pageview_url = '/restaurants' THEN 1 ELSE 0 END) AS restaurants_views,
    MAX(CASE WHEN pageview_url = '/menu' THEN 1 ELSE 0 END) AS menu_views,
    MAX(CASE WHEN pageview_url = '/cart' THEN 1 ELSE 0 END) AS cart_views
FROM app_pageviews
GROUP BY app_session_id;

2.4 Orders per Session
CREATE TEMPORARY TABLE orders_per_sessions AS
SELECT
    app_session_id,
    COUNT(DISTINCT CASE WHEN order_status = 'Completed' THEN order_id END) AS completed_orders,
    COUNT(DISTINCT CASE WHEN order_status = 'Cancelled' THEN order_id END) AS cancelled_orders,
    SUM(CASE WHEN order_status = 'Completed' THEN net_revenue ELSE 0 END) AS net_revenue_completed_orders,
    SUM(CASE WHEN order_status = 'Cancelled' THEN net_revenue ELSE 0 END) AS net_revenue_cancelled_orders,
    SUM(net_revenue) AS net_revenue_all_orders
FROM net_GMV_orders
GROUP BY app_session_id;

2.5 Funnel Metrics
SELECT
    SUM(s.homepage_views) AS homepage_sessions,
    SUM(s.search_views) AS search_sessions,
    ROUND(SUM(s.search_views) * 100 / NULLIF(SUM(s.homepage_views),0),2) AS pct_home_to_search,

    SUM(s.restaurants_views) AS restaurants_sessions,
    ROUND(SUM(s.restaurants_views) * 100 / NULLIF(SUM(s.search_views),0),2) AS pct_search_to_restaurants,

    SUM(s.menu_views) AS menu_sessions,
    ROUND(SUM(s.menu_views) * 100 / NULLIF(SUM(s.restaurants_views),0),2) AS pct_restaurants_to_menu,

    SUM(s.cart_views) AS cart_sessions,
    ROUND(SUM(s.cart_views) * 100 / NULLIF(SUM(s.menu_views),0),2) AS pct_menu_to_cart,

    SUM(o.completed_orders) AS placed_orders,
    ROUND(SUM(o.completed_orders) * 100 / NULLIF(SUM(s.cart_views),0),2) AS pct_cart_to_order,

    ROUND(100 - (SUM(o.completed_orders) * 100 / NULLIF(SUM(s.cart_views),0)),2) AS cart_abandonment_rate,

    SUM(o.net_revenue_completed_orders) AS total_revenue,
    (-1 * SUM(o.net_revenue_cancelled_orders)) AS total_refunds,
    SUM(o.net_revenue_all_orders) AS net_revenue_all_orders,
    AVG(o.net_revenue_all_orders) AS net_revenue_per_order
FROM pageviews_per_session s
LEFT JOIN orders_per_sessions o
ON s.app_session_id = o.app_session_id;
